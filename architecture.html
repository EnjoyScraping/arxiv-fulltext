
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Architecture &#8212; arXiv Fulltext Extraction Service 0.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="fulltext package" href="fulltext/fulltext.html" />
    <link rel="prev" title="arXiv Fulltext Extraction Service" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="architecture">
<h1>Architecture<a class="headerlink" href="#architecture" title="Permalink to this headline">¶</a></h1>
<div class="section" id="context">
<h2>Context<a class="headerlink" href="#context" title="Permalink to this headline">¶</a></h2>
<p>The fulltext extraction service is used during the submission process as part
of QA/QC workflows, and after announcement to support indexing and other
downstream applications.</p>
<div class="figure align-center" id="id1">
<span id="figure-context"></span><a class="reference internal image-reference" href="_images/fulltext-service-context.png"><img alt="_images/fulltext-service-context.png" src="_images/fulltext-service-context.png" style="width: 450px;" /></a>
<p class="caption"><span class="caption-text">System context for the fulltext extraction service.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>The submission worker process will request fulltext content for submissions by
making a GET request to the fulltext service. If an extraction for the
submission using the latest version of the extractor does not exist, the
service will retrieve the compiled PDF for the submission from the compilation
service and perform the extraction. The submission worker may force
re-extraction (e.g. if the submission content changes) by making a POST
request.</p>
<p>When a new e-print is announced, the publication process generates a
notification on a Kinesis stream that is consumed by the extraction service.
The extraction service retrieves the PDF for the e-print, performs the
extraction, and makes the result available via its API.</p>
<p>Clients (including both arXiv services and external API clients) may request
the latest extraction by making a GET request. If an extraction does not exist
for the paper using the most recent version of the extraction process, the
service retrieves the paper and performs the extraction.</p>
</div>
<div class="section" id="containers">
<h2>Containers<a class="headerlink" href="#containers" title="Permalink to this headline">¶</a></h2>
<p>A web application implemented in Flask handles HTTP requests for
extractions. Extraction can be requested via POST request, which creates a
task for a worker process on a Redis queue (using Celery).</p>
<p>The worker process monitors the Redis queue, and does the work of retrieving
PDFs, performing extractions, and storing the results. A Docker-in-Docker
container is deployed as a side-car to the worker; the worker performs
extraction by running the <code class="docutils literal notranslate"><span class="pre">arxiv/fulltext-extractor</span></code> image in the dind
container.</p>
<p>Extractions are stored on a network filesystem, and organized by submission or
e-print ID and extractor version. When an extraction task is created, a
placeholder file with the task ID is stored where the content will eventually
be. This helps to prevent duplicate extraction tasks.</p>
<div class="figure align-center" id="id2">
<span id="figure-containers"></span><a class="reference internal image-reference" href="_images/fulltext-service-containers.png"><img alt="_images/fulltext-service-containers.png" src="_images/fulltext-service-containers.png" style="width: 450px;" /></a>
<p class="caption"><span class="caption-text">Container-level view of the fulltext extraction service.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="components">
<h2>Components<a class="headerlink" href="#components" title="Permalink to this headline">¶</a></h2>
<p>The fulltext extraction service implements the general architecture described
in <a class="reference external" href="https://arxiv.github.io/arxiv-arxitecture/crosscutting/services.html" title="(in arXiv arXitecture v0.9)"><span>Services in arXiv NG</span></a>.</p>
<div class="figure align-center" id="id3">
<span id="figure-components"></span><a class="reference internal image-reference" href="_images/fulltext-service-components.png"><img alt="_images/fulltext-service-components.png" src="_images/fulltext-service-components.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text">Component-level view of the fulltext extraction service.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p>Two service modules, <a class="reference internal" href="fulltext/fulltext.services.pdf.html#module-fulltext.services.pdf" title="fulltext.services.pdf"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fulltext.services.pdf</span></code></a> and
<a class="reference internal" href="fulltext/fulltext.services.store.html#module-fulltext.services.store" title="fulltext.services.store"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fulltext.services.store</span></code></a>, provide integration with arXiv PDF content
and the filesystem, respectively.</p>
<p><a class="reference internal" href="fulltext/fulltext.routes.html#module-fulltext.routes" title="fulltext.routes"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fulltext.routes</span></code></a> defines the HTTP API exposed by the
<a class="reference internal" href="fulltext/fulltext.factory.html#module-fulltext.factory" title="fulltext.factory"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fulltext.factory</span></code></a> application entry-point. Request handling is
performed by <a class="reference internal" href="fulltext/fulltext.controllers.html#module-fulltext.controllers" title="fulltext.controllers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fulltext.controllers</span></code></a>, which orchestrates loading of
fulltext content and generates extraction tasks via <a class="reference internal" href="fulltext/fulltext.extract.html#module-fulltext.extract" title="fulltext.extract"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fulltext.extract</span></code></a>.</p>
<p>The <a class="reference internal" href="fulltext/fulltext.worker.html#module-fulltext.worker" title="fulltext.worker"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fulltext.worker</span></code></a> module provides an entry-point for the extraction
worker process, which listens for tasks defined in <a class="reference internal" href="fulltext/fulltext.extract.html#module-fulltext.extract" title="fulltext.extract"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fulltext.extract</span></code></a>.</p>
<p>The extraction task itself (in <a class="reference internal" href="fulltext/fulltext.extract.html#module-fulltext.extract" title="fulltext.extract"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fulltext.extract</span></code></a>) uses a Docker image
(<code class="docutils literal notranslate"><span class="pre">extractor</span></code>) to perform the actual extraction. This is defined separately
from the main application.</p>
</div>
<div class="section" id="authentication-authorization">
<h2>Authentication &amp; Authorization<a class="headerlink" href="#authentication-authorization" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">fulltext:create</span></code> scope is required to request new extractions. The
<code class="docutils literal notranslate"><span class="pre">fulltext:read</span></code> scope is required to access extracted plain text. The latter
will be more common with external API consumers, whereas <code class="docutils literal notranslate"><span class="pre">fulltext:create</span></code>
is primarily intended for other services.</p>
<p>To extract text from submissions, the <code class="docutils literal notranslate"><span class="pre">compile:read</span></code> scope is also required.</p>
<p>Whereas announced e-prints require no special ownership privileges, submissions
are more protected. The compiler service (from whence we obtain PDFs for
submissions from which to extract text) publishes the identity of the resource
owner (their user ID) via the <code class="docutils literal notranslate"><span class="pre">ARXIV-OWNER</span></code> header. The plaintext extraction
service must implement authorization checks to ensure that only the owner (or a
delegate with global or explicit privileges for that resource) may request
extraction and access the status/results of the extraction.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">arXiv Fulltext Extraction Service</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#context">Context</a></li>
<li class="toctree-l2"><a class="reference internal" href="#containers">Containers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#components">Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="#authentication-authorization">Authentication &amp; Authorization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fulltext/fulltext.html">fulltext package</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">arXiv Fulltext Extraction Service</a></li>
      <li>Next: <a href="fulltext/fulltext.html" title="next chapter">fulltext package</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, arXiv.org.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/architecture.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>